<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhysiVerse - Tạp chí Khoa học & Công nghệ</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/showdown/dist/showdown.min.js"></script>

    <style>
        :root {
            --primary-color: #0A2F5B; --secondary-color: #005A9C; --accent-color: #E8A87C;
            --text-color: #333333; --light-gray: #f8f9fa; --border-color: #dee2e6;
            --font-heading: 'Lora', serif; --font-body: 'Montserrat', sans-serif;
            --shadow: 0 4px 15px rgba(0,0,0,0.07);
            --bg-color: #ffffff;
            --card-bg-color: #ffffff;
        }

        body.dark-mode {
            --primary-color: #a7c7e7; --secondary-color: #89cff0; --accent-color: #f0b98d;
            --text-color: #c9d1d9; --light-gray: #161b22; --border-color: #30363d;
            --bg-color: #0d1117;
            --card-bg-color: #161b22;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-body); line-height: 1.7; color: var(--text-color); background-color: var(--bg-color); transition: background-color 0.3s, color 0.3s; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        #reading-progress-bar { position: fixed; top: 0; left: 0; height: 4px; background-color: var(--accent-color); width: 0%; z-index: 9999; transition: width 0.1s; }

        .loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8); display: flex; justify-content: center; align-items: center; z-index: 9998; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; }
        body.dark-mode .loader-overlay { background: rgba(13, 17, 23, 0.8); }
        .loader-overlay.show { opacity: 1; visibility: visible; }
        .loader { border: 8px solid #f3f3f3; border-top: 8px solid var(--primary-color); border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; }
        body.dark-mode .loader { border-color: #21262d; border-top-color: var(--primary-color); }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .main-header { background-color: var(--bg-color); border-bottom: 1px solid var(--border-color); padding: 15px 0; position: sticky; top: 0; z-index: 1000; transition: box-shadow 0.3s ease, background-color 0.3s; }
        .main-header.scrolled { box-shadow: var(--shadow); }
        .main-header .container { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: var(--font-heading); color: var(--primary-color); font-size: 2.5rem; margin: 0; font-weight: 700; text-decoration: none; }
        .header-right { display: flex; align-items: center; gap: 20px; }
        .main-nav ul { list-style: none; display: flex; }
        .main-nav li { margin-left: 30px; }
        .main-nav a { text-decoration: none; color: var(--text-color); font-weight: 500; font-size: 1rem; padding-bottom: 5px; position: relative; }
        .main-nav a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: 0; left: 50%; background-color: var(--accent-color); transition: all 0.3s ease-in-out; }
        .main-nav a:hover, .main-nav a:hover::after, .main-nav a.active { color: var(--accent-color); }
        .main-nav a.active::after { width: 100%; left: 0; }
        
        #theme-toggle { background: none; border: none; cursor: pointer; color: var(--text-color); padding: 5px; }
        #theme-toggle svg { width: 24px; height: 24px; fill: currentColor; transition: transform 0.3s ease; }
        #theme-toggle:hover svg { transform: scale(1.2); }

        .hero-section { background: linear-gradient(rgba(10, 47, 91, 0.85), rgba(10, 47, 91, 0.85)), url('https://placehold.co/1920x1080/0A2F5B/FFFFFF?text=PhysiVerse+Background') no-repeat center center; background-size: cover; color: #fff; text-align: center; padding: 120px 0; }
        .hero-section h2 { font-family: var(--font-heading); font-size: 3.5rem; margin-bottom: 20px; font-weight: 700; }
        .hero-section p { font-size: 1.25rem; max-width: 700px; margin: 0 auto 40px auto; opacity: 0.9; }
        .btn-secondary { background-color: var(--accent-color); color: #fff; padding: 12px 28px; font-size: 1.05rem; text-decoration: none; border-radius: 5px; transition: all 0.3s ease; display: inline-block; }
        .btn-secondary:hover { background-color: #d99160; transform: translateY(-2px); }

        .latest-issue { padding: 80px 0; background-color: var(--light-gray); min-height: 400px; transition: background-color 0.3s; }
        .section-title { text-align: center; font-family: var(--font-heading); font-size: 2.8rem; color: var(--primary-color); margin-bottom: 60px; position: relative; }
        .section-title::after { content: ''; display: block; width: 80px; height: 3px; background-color: var(--accent-color); margin: 15px auto 0; }
        
        #no-articles-message { text-align: center; color: #6c757d; padding: 50px 0; }
        #no-articles-message h3 { font-family: var(--font-heading); margin-bottom: 10px; }
        
        .filters-container { display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap; max-width: 800px; margin: -20px auto 40px auto; }
        .search-bar { flex-grow: 1; min-width: 250px; }
        .search-bar input, .category-filter select { width: 100%; padding: 15px 20px; font-size: 1rem; border-radius: 50px; border: 1px solid var(--border-color); background-color: var(--card-bg-color); color: var(--text-color); transition: all 0.3s; }
        .search-bar input:focus, .category-filter select:focus { outline: none; box-shadow: 0 0 0 4px rgba(0, 90, 156, 0.2); border-color: var(--secondary-color); }

        .articles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; }
        .article-card { background-color: var(--card-bg-color); border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; box-shadow: var(--shadow); transition: all 0.3s ease; cursor: pointer; text-decoration: none; opacity: 0; transform: translateY(20px); animation: fadeInCard 0.5s ease-out forwards; }
        @keyframes fadeInCard { to { opacity: 1; transform: translateY(0); } }
        .article-card:hover { transform: translateY(-8px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .article-image { width: 100%; height: 220px; object-fit: cover; background-color: var(--light-gray); }
        .article-content { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .article-category { display: inline-block; background-color: var(--secondary-color); color: #fff; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; font-weight: bold; margin-bottom: 15px; align-self: flex-start; }
        .article-title { font-family: var(--font-heading); font-size: 1.4rem; margin-bottom: 10px; color: var(--primary-color); transition: color 0.3s ease;}
        .article-card:hover .article-title { color: var(--accent-color); }
        .article-authors { font-size: 0.9rem; color: #6c757d; margin-bottom: 15px; }
        .article-excerpt { margin-bottom: 20px; flex-grow: 1; color: var(--text-color); }
        
        .page-section { display: none; animation: slideUp 0.5s ease-in-out; }
        .page-section.active { display: block; }

        #articleDetailPage { padding: 80px 0; }
        .article-detail-container { max-width: 800px; margin: 0 auto; background: var(--card-bg-color); padding: 40px; border-radius: 8px; box-shadow: var(--shadow); }
        .article-detail-header img { width: 100%; max-height: 400px; object-fit: cover; border-radius: 5px; margin-bottom: 20px; background-color: var(--light-gray); }
        .article-detail-header h1 { font-family: var(--font-heading); font-size: 2.8rem; color: var(--primary-color); line-height: 1.3; margin-bottom: 15px; }
        .article-meta { font-size: 0.9rem; color: #6c757d; margin-bottom: 30px; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color); padding: 15px; background-color: var(--light-gray); border-radius: 5px; }
        .article-meta p { margin: 5px 0; }
        .article-meta strong { color: var(--text-color); }
        .article-meta .reading-time { font-style: italic; }
        .article-full-content { font-size: 1.1rem; line-height: 1.8; }
        .article-full-content h1, .article-full-content h2, .article-full-content h3 { font-family: var(--font-heading); color: var(--primary-color); margin-top: 30px; margin-bottom: 15px; }
        .article-full-content p { margin-bottom: 1rem; }
        .article-full-content blockquote { border-left: 4px solid var(--accent-color); padding-left: 20px; margin: 20px 0; font-style: italic; color: #555; }
        body.dark-mode .article-full-content blockquote { color: #aaa; }
        .article-full-content img { max-width: 100%; height: auto; border-radius: 5px; margin: 1rem 0; }
        .article-full-content pre { background-color: #f4f4f4; padding: 20px; border-radius: 5px; overflow-x: auto; position: relative; }
        body.dark-mode .article-full-content pre { background-color: #010409; }
        .article-full-content code { font-family: 'Courier New', Courier, monospace; }
        .copy-code-btn { position: absolute; top: 10px; right: 10px; background-color: #ddd; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; opacity: 0; transition: opacity 0.3s; }
        body.dark-mode .copy-code-btn { background-color: #222; color: #eee; }
        .article-full-content pre:hover .copy-code-btn { opacity: 1; }
        .share-section { margin-top: 40px; border-top: 1px solid var(--border-color); padding-top: 20px; text-align: center; }
        .share-section h4 { margin-bottom: 15px; }
        .share-buttons a { display: inline-block; margin: 0 10px; transition: transform 0.2s; }
        .share-buttons a:hover { transform: scale(1.1); }
        .share-buttons svg { width: 32px; height: 32px; fill: #6c757d; }
        body.dark-mode .share-buttons svg { fill: #888; }
        #backToHomeBtn { margin-bottom: 40px; display: inline-block; background-color: var(--primary-color); color: #fff; padding: 10px 20px; border-radius: 5px; text-decoration: none; transition: all 0.3s ease; }
        #backToHomeBtn:hover { background-color: var(--secondary-color); }

        .page-content-container { max-width: 900px; margin: 0 auto; background: var(--card-bg-color); padding: 40px; border-radius: 8px; box-shadow: var(--shadow); line-height: 1.8; transition: background-color 0.3s;}
        .page-content-container p, .page-content-container ul { margin-bottom: 1.5rem; }
        .page-content-container h3 { font-family: var(--font-heading); color: var(--secondary-color); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem; }
        
        .main-footer { background-color: var(--card-bg-color); border-top: 1px solid var(--border-color); color: var(--text-color); padding: 60px 0; line-height: 1.8; transition: all 0.3s; }
        .footer-container { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .footer-logo { font-family: var(--font-heading); color: var(--primary-color); font-size: 2rem; margin: 0; font-weight: 700; text-decoration: none; }
        .footer-description { max-width: 500px; margin: 15px 0 25px 0; color: #6c757d; }
        body.dark-mode .footer-description { color: #888; }
        .footer-socials { list-style: none; display: flex; gap: 20px; margin-bottom: 30px; }
        .footer-socials a { color: var(--text-color); transition: color 0.3s, transform 0.3s; }
        .footer-socials a:hover { color: var(--accent-color); transform: scale(1.2); }
        .footer-socials svg { width: 24px; height: 24px; fill: currentColor; }
        .footer-copyright { font-size: 0.9rem; color: #6c757d; }
        body.dark-mode .footer-copyright { color: #888; }

        #scrollToTopBtn { display: none; position: fixed; bottom: 30px; right: 30px; z-index: 99; border: none; outline: none; background-color: var(--primary-color); color: white; cursor: pointer; padding: 15px; border-radius: 50%; font-size: 18px; width: 50px; height: 50px; transition: all 0.3s; opacity: 0.8; }
        #scrollToTopBtn:hover { opacity: 1; transform: scale(1.1); }
        
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        @media (max-width: 768px) {
            .hero-section h2 { font-size: 2.5rem; }
            .main-header .container { flex-wrap: wrap; justify-content: center; }
            .logo { width: 100%; text-align: center; margin-bottom: 15px; }
            .header-right { width: 100%; justify-content: center; }
            .main-nav ul { padding-left: 0; }
        }
    </style>
</head>
<body>
    <div id="reading-progress-bar"></div>
    <div class="loader-overlay show" id="loader-overlay">
        <div class="loader"></div>
    </div>

    <header class="main-header" id="mainHeader">
        <div class="container">
            <a href="#" class="logo nav-link" data-target="homePage">PhysiVerse</a>
            <div class="header-right">
                <nav class="main-nav">
                    <ul>
                        <li><a href="#" class="nav-link active" data-target="homePage">Trang Chủ</a></li>
                        <li><a href="#" class="nav-link" data-target="aboutUsPage">Về Chúng Tôi</a></li>
                    </ul>
                </nav>
                <button id="theme-toggle" title="Chuyển chế độ Sáng/Tối">
                    <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,4.39L16.22,3.22L17.61,5.61L19.78,6.22L19.61,8.61L21.78,9.78L20.61,12.22L21.78,14.61L19.61,15.78L19.78,18.22L17.61,18.78L16.22,21.22L14.39,19.61L12,22L9.61,19.61L7.78,21.22L6.39,18.78L4.22,18.22L4.39,15.78L2.22,14.61L3.39,12.22L2.22,9.78L4.39,8.61L4.22,6.22L6.39,5.61L7.78,3.22L9.61,4.39L12,2Z" /></svg>
                    <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display: none;"><path d="M12 2A9.91 9.91 0 0 0 9 2.46A10 10 0 0 1 9 21.54A10 10 0 1 0 12 2Z" /></svg>
                </button>
            </div>
        </div>
    </header>

    <main id="main-content">
        <!-- Nội dung sẽ được render vào đây bởi JavaScript -->
    </main>
    
    <footer class="main-footer">
        <div class="container footer-container">
            <a href="#" class="footer-logo nav-link" data-target="homePage">PhysiVerse</a>
            <p class="footer-description">Tạp chí khoa học & công nghệ truy cập mở, dành riêng cho việc phổ biến tri thức và thúc đẩy các khám phá tiên phong.</p>
            <ul class="footer-socials">
                <li><a href="#" title="Twitter"><svg viewBox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 2.9,4.79C2.53,5.42 2.33,6.16 2.33,6.94C2.33,8.43 3.11,9.75 4.32,10.49C3.62,10.47 2.96,10.28 2.38,10V10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg></a></li>
                <li><a href="#" title="GitHub"><svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z" /></svg></a></li>
                <li><a href="#" title="LinkedIn"><svg viewBox="0 0 24 24"><path d="M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19M18.5,18.5V13.2A3.26,3.26 0 0,0 15.24,9.94C14.39,9.94 13.4,10.43 13,11.1V10.13H10V18.5H13V13.09C13,12.31 13.3,11.92 13.9,11.92C14.5,11.92 15.24,12.31 15.24,13.2V18.5H18.5M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,18.5V10.13H5V18.5H8Z" /></svg></a></li>
            </ul>
            <p class="footer-copyright">&copy; 2025 PhysiVerse. All Rights Reserved.</p>
        </div>
    </footer>
    
    <button id="scrollToTopBtn" title="Lên đầu trang">&#8679;</button>

    <script src="https://cdn.jsdelivr.net/npm/showdown/dist/showdown.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const ui = {
                loader: document.getElementById('loader-overlay'),
                header: document.getElementById('mainHeader'),
                mainContent: document.getElementById('main-content'),
                scrollToTopBtn: document.getElementById('scrollToTopBtn'),
                themeToggle: document.getElementById('theme-toggle'),
                sunIcon: document.getElementById('theme-icon-sun'),
                moonIcon: document.getElementById('theme-icon-moon'),
                progressBar: document.getElementById('reading-progress-bar'),
            };

            const showdownConverter = new showdown.Converter({ metadata: true, tables: true, emoji: true, openLinksInNewWindow: true });
            let allArticlesCache = [];

            const showLoader = () => ui.loader.classList.add('show');
            const hideLoader = () => ui.loader.classList.remove('show');

            const fetchArticle = async (id) => {
                try {
                    // SỬA LỖI CACHE: Thêm tham số ngẫu nhiên để buộc tải lại
                    const response = await fetch(`./articles/${id}.md?v=${new Date().getTime()}`);
                    if (!response.ok) return null;
                    const markdown = await response.text();
                    const htmlContent = showdownConverter.makeHtml(markdown);
                    const metadata = showdownConverter.getMetadata();
                    return { id, ...metadata, content: htmlContent };
                } catch (error) {
                    return null;
                }
            };

            const fetchAllArticles = async () => {
                let articles = [];
                let id = 1;
                while(true) {
                    const article = await fetchArticle(id);
                    if (article) {
                        articles.push(article);
                        id++;
                    } else {
                        // Thử thêm 2 lần nữa để phòng trường hợp file bị lỗi mạng tạm thời
                        let retries = 2;
                        let found = false;
                        for(let i=0; i<retries; i++){
                            const retryArticle = await fetchArticle(id);
                            if(retryArticle){
                                articles.push(retryArticle);
                                id++;
                                found = true;
                                break;
                            }
                        }
                        if(!found) break;
                    }
                }
                allArticlesCache = articles.sort((a, b) => new Date(b.date.split('/').reverse().join('-')) - new Date(a.date.split('/').reverse().join('-')));
            };

            const renderHomePage = (articlesToRender = allArticlesCache) => {
                const categories = [...new Set(allArticlesCache.map(a => a.category))];
                let articlesHTML = '';

                if (articlesToRender.length > 0) {
                    articlesToRender.forEach((article, index) => {
                        articlesHTML += `
                            <a href="#article/${article.id}" class="article-card" data-id="${article.id}" style="animation-delay: ${index * 100}ms">
                                <img src="${article.coverImage}" alt="${article.title}" class="article-image">
                                <div class="article-content">
                                    <span class="article-category">${article.category}</span>
                                    <h4 class="article-title">${article.title}</h4>
                                    <p class="article-authors">Bởi ${article.authors}</p>
                                    <p class="article-excerpt">${article.excerpt}</p>
                                </div>
                            </a>`;
                    });
                }

                ui.mainContent.innerHTML = `
                    <section id="homePage" class="page-section active">
                        <section class="hero-section">
                            <div class="container">
                                <h2>Khám Phá Ranh Giới Mới Của Tri Thức</h2>
                                <p>Nơi công bố những nghiên cứu đột phá trong lĩnh vực Vật lý, Công nghệ và Trí tuệ nhân tạo.</p>
                                <a href="#latest-issue-section" class="btn-secondary">Xem Bài Mới Nhất</a>
                            </div>
                        </section>
                        <section class="latest-issue" id="latest-issue-section">
                            <div class="container">
                                <h3 class="section-title">Nghiên Cứu Nổi Bật</h3>
                                <div class="filters-container">
                                    <div class="search-bar">
                                        <input type="text" id="homeSearchInput" placeholder="Tìm kiếm bài báo...">
                                    </div>
                                    <div class="category-filter">
                                        <select id="categoryFilter">
                                            <option value="">Tất cả chuyên mục</option>
                                            ${categories.map(cat => `<option value="${cat}">${cat}</option>`).join('')}
                                        </select>
                                    </div>
                                </div>
                                <div id="articles-grid-container" class="articles-grid">
                                    ${articlesHTML}
                                </div>
                                <div id="no-articles-message" style="display: ${articlesToRender.length === 0 ? 'block' : 'none'};">
                                    <h3>Không tìm thấy bài báo nào phù hợp.</h3>
                                </div>
                            </div>
                        </section>
                    </section>`;
            };
            
            const calculateReadingTime = (htmlContent) => {
                const text = htmlContent.replace(/<[^>]+>/g, '');
                const wordsPerMinute = 200;
                const wordCount = text.split(/\s+/).length;
                const readingTime = Math.ceil(wordCount / wordsPerMinute);
                return `☕️ ${readingTime} phút đọc`;
            };

            const renderArticlePage = (article) => {
                const readingTime = calculateReadingTime(article.content);
                ui.mainContent.innerHTML = `
                    <section id="articleDetailPage" class="page-section active">
                        <div class="container">
                            <a href="#" id="backToHomeBtn" class="nav-link" data-target="homePage">&larr; Quay lại Trang chủ</a>
                            <div class="article-detail-container">
                                <div class="article-detail-header">
                                    <img src="${article.coverImage}" alt="Article Cover Image">
                                    <h1>${article.title}</h1>
                                    <div class="article-meta">
                                        <p><strong>Tác giả:</strong> ${article.authors}</p>
                                        <p><strong>Đơn vị:</strong> ${article.affiliation}</p>
                                        <p><strong>Email:</strong> <a href="mailto:${article.email}">${article.email}</a></p>
                                        <p><strong>Ngày đăng:</strong> ${article.date} | <strong>Chuyên ngành:</strong> ${article.category}</p>
                                        <p class="reading-time">${readingTime}</p>
                                    </div>
                                </div>
                                <div class="article-full-content">${article.content}</div>
                                <div class="share-section">
                                    <h4>Chia sẻ bài viết</h4>
                                    <div class="share-buttons" id="share-buttons"></div>
                                </div>
                            </div>
                        </div>
                    </section>`;
                addCopyButtonsToCodeBlocks();
                renderShareButtons(article);
            };

             const renderAboutPage = () => {
                ui.mainContent.innerHTML = `
                    <section id="aboutUsPage" class="page-section active" style="padding: 80px 0;">
                        <div class="container">
                            <h2 class="section-title">Về Chúng Tôi</h2>
                            <div class="page-content-container">
                                <h3>Tầm Nhìn</h3>
                                <p>PhysiVerse được xây dựng với tầm nhìn trở thành một kho lưu trữ tri thức hiện đại, dễ tiếp cận và đáng tin cậy. Chúng tôi mong muốn tạo ra một không gian nơi những ý tưởng đột phá và các công trình nghiên cứu tâm huyết được trình bày một cách trang trọng, thẩm mỹ và lan tỏa mạnh mẽ đến cộng đồng.</p>
                                <h3>Sứ Mệnh</h3>
                                <p>Sứ mệnh của chúng tôi là phá vỡ các rào cản trong việc tiếp cận tri thức khoa học. Bằng cách cung cấp một nền tảng xuất bản truy cập mở, nhanh chóng và hoàn toàn miễn phí, chúng tôi kết nối cộng đồng các nhà nghiên cứu, sinh viên và những người yêu khoa học, đồng thời truyền cảm hứng cho thế hệ các nhà khoa học tương lai.</p>
                                <h3>Giá Trị Cốt Lõi</h3>
                                <ul>
                                    <li><b>Truy cập Mở:</b> Mọi tri thức đều được chia sẻ miễn phí, không giới hạn.</li>
                                    <li><b>Tốc độ:</b> Mô hình tĩnh giúp trang web tải cực nhanh, mang lại trải nghiệm đọc tốt nhất.</li>
                                    <li><b>Sự Tối giản:</b> Giao diện tập trung vào nội dung, loại bỏ những yếu tố gây xao lãng.</li>
                                    <li><b>Cộng đồng:</b> Khuyến khích sự chia sẻ và lan tỏa kiến thức khoa học.</li>
                                </ul>
                            </div>
                        </div>
                    </section>`;
            };

            const addCopyButtonsToCodeBlocks = () => {
                const codeBlocks = document.querySelectorAll('.article-full-content pre');
                codeBlocks.forEach(block => {
                    const button = document.createElement('button');
                    button.className = 'copy-code-btn';
                    button.textContent = 'Copy';
                    block.appendChild(button);

                    button.addEventListener('click', () => {
                        const code = block.querySelector('code').innerText;
                        navigator.clipboard.writeText(code).then(() => {
                            button.textContent = 'Đã chép!';
                            setTimeout(() => {
                                button.textContent = 'Copy';
                            }, 2000);
                        });
                    });
                });
            };

            const renderShareButtons = (article) => {
                const url = encodeURIComponent(window.location.href);
                const title = encodeURIComponent(article.title);
                const container = document.getElementById('share-buttons');
                container.innerHTML = `
                    <a href="https://twitter.com/intent/tweet?url=${url}&text=${title}" target="_blank" class="share-twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 2.9,4.79C2.53,5.42 2.33,6.16 2.33,6.94C2.33,8.43 3.11,9.75 4.32,10.49C3.62,10.47 2.96,10.28 2.38,10V10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg></a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=${url}" target="_blank" class="share-facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 21.96V14.96H7.9V12.06H10.44V9.85C10.44 7.32 11.93 5.96 14.22 5.96C15.31 5.96 16.45 6.15 16.45 6.15V8.62H15.19C13.95 8.62 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.96H13.56V21.96A10 10 0 0 0 22 12.06C22 6.53 17.5 2.04 12 2.04Z" /></svg></a>
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}" target="_blank" class="share-linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19M18.5,18.5V13.2A3.26,3.26 0 0,0 15.24,9.94C14.39,9.94 13.4,10.43 13,11.1V10.13H10V18.5H13V13.09C13,12.31 13.3,11.92 13.9,11.92C14.5,11.92 15.24,12.31 15.24,13.2V18.5H18.5M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,18.5V10.13H5V18.5H8Z" /></svg></a>
                `;
            };

            const handleFilters = () => {
                const searchTerm = document.getElementById('homeSearchInput').value.toLowerCase();
                const selectedCategory = document.getElementById('categoryFilter').value;
                
                let filtered = allArticlesCache;
                if (searchTerm) {
                    filtered = filtered.filter(a => a.title.toLowerCase().includes(searchTerm) || a.authors.toLowerCase().includes(searchTerm));
                }
                if (selectedCategory) {
                    filtered = filtered.filter(a => a.category === selectedCategory);
                }
                
                const grid = document.getElementById('articles-grid-container');
                const noResults = document.getElementById('no-articles-message');
                grid.innerHTML = '';
                if (filtered.length === 0) {
                    noResults.style.display = 'block';
                } else {
                    noResults.style.display = 'none';
                    filtered.forEach((article, index) => {
                         grid.insertAdjacentHTML('beforeend', `
                            <a href="#article/${article.id}" class="article-card" data-id="${article.id}" style="animation-delay: ${index * 100}ms">
                                <img src="${article.coverImage}" alt="${article.title}" class="article-image">
                                <div class="article-content">
                                    <span class="article-category">${article.category}</span>
                                    <h4 class="article-title">${article.title}</h4>
                                    <p class="article-authors">Bởi ${article.authors}</p>
                                    <p class="article-excerpt">${article.excerpt}</p>
                                </div>
                            </a>`);
                    });
                }
            };
            
            const router = () => {
                const path = window.location.hash.slice(1) || 'homePage';
                const articleIdMatch = path.match(/^article\/(\d+)$/);

                if (articleIdMatch) {
                    const articleId = parseInt(articleIdMatch[1]);
                    const article = allArticlesCache.find(a => a.id == articleId);
                    if (article) {
                        document.title = `${article.title} | PhysiVerse`;
                        renderArticlePage(article);
                    } else {
                        window.location.hash = '';
                    }
                } else if (path === 'aboutUsPage') {
                    document.title = 'Về Chúng Tôi | PhysiVerse';
                    renderAboutPage();
                } else {
                    document.title = 'PhysiVerse - Tạp chí Khoa học & Công nghệ';
                    renderHomePage();
                }
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.dataset.target === path);
                });
                window.scrollTo(0, 0);
            };

            const applyTheme = (theme) => {
                if (theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    ui.sunIcon.style.display = 'none';
                    ui.moonIcon.style.display = 'block';
                } else {
                    document.body.classList.remove('dark-mode');
                    ui.sunIcon.style.display = 'block';
                    ui.moonIcon.style.display = 'none';
                }
            };
            
            const updateReadingProgress = () => {
                const articleContent = document.querySelector('.article-detail-container');
                if(!articleContent) {
                    ui.progressBar.style.width = '0%';
                    return;
                }
                const scrollableHeight = articleContent.scrollHeight - window.innerHeight;
                const scrollTop = articleContent.getBoundingClientRect().top;
                
                if (scrollTop > 0) { // Not yet started scrolling into the article
                     ui.progressBar.style.width = '0%';
                } else {
                     const progress = (Math.abs(scrollTop) / scrollableHeight) * 100;
                     ui.progressBar.style.width = `${Math.min(progress, 100)}%`;
                }
            };
            
            // --- EVENT LISTENERS ---
            window.addEventListener('hashchange', router);

            document.body.addEventListener('click', (e) => {
                 const navLink = e.target.closest('.nav-link');
                 if (navLink) {
                     e.preventDefault();
                     window.location.hash = navLink.dataset.target;
                 }
                 const articleCard = e.target.closest('a.article-card');
                 if (articleCard) {
                     e.preventDefault();
                     window.location.hash = `article/${articleCard.dataset.id}`;
                 }
            });

            ui.mainContent.addEventListener('input', (e) => { if (e.target.id === 'homeSearchInput') handleFilters(); });
            ui.mainContent.addEventListener('change', (e) => { if (e.target.id === 'categoryFilter') handleFilters(); });

            window.addEventListener('scroll', () => {
                const isScrolled = document.body.scrollTop > 100 || document.documentElement.scrollTop > 100;
                ui.header.classList.toggle('scrolled', isScrolled);
                ui.scrollToTopBtn.style.display = isScrolled ? "block" : "none";
                updateReadingProgress();
            });
            ui.scrollToTopBtn.addEventListener('click', () => window.scrollTo({top: 0, behavior: 'smooth'}));
            
            ui.themeToggle.addEventListener('click', () => {
                const currentTheme = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                applyTheme(newTheme);
            });

            // --- INITIALIZATION ---
            const init = async () => {
                showLoader();
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (savedTheme) {
                    applyTheme(savedTheme);
                } else if (prefersDark) {
                    applyTheme('dark');
                } else {
                    applyTheme('light');
                }
                await fetchAllArticles();
                router();
                hideLoader();
            };

            init();
        });
    </script>
</body>
</html>
